#pragma once

#ifndef GAME_H
#define GAME_H

#include "UnitGenerator.h"
#include "Armys/AlienArmy.h"
#include "Armys/EarthArmy.h"
#include <string>
#include <Windows.h>

#define ESC "\x1b"
#define CSI "\x1b["

#define FOREGROUND_WHITE FOREGROUND_BLUE | FOREGROUND_RED | FOREGROUND_GREEN
#define FOREGROUND_YELLOW FOREGROUND_RED | FOREGROUND_GREEN
enum class FocusMode {
	InFileInput,
	OutFileInput,
	ModeSelection
};
enum class UIMode {
	Interactive ,
	Silent,
	None
};
enum EndBattle {
	DRAW,
	ALIENWON,
	EARTHWON,
	CONTINUE
};
class Game
{
	AlienArmy* alienArmy;
	EarthArmy* earthArmy;
	LinkedQueue<Unit* > KilledList;
	EndBattle endbattle = CONTINUE;
	string inputFileDir;
	string outputFileDir;
	UIMode uiMode = UIMode::Interactive;

	int InfectionThreshold;
	int currentTimeStep = 0;


	bool playsound = false;
public:
	Game();

	//Getters
	AlienArmy* GetAlienArmy();
	EarthArmy* GetEarthArmy();
	UIMode GetUIMode() const;

	//Game Functions
	void StartSimulation();
	void ReportDeadUnit(Unit*);
	int GetTimeStamp();
	void ReportHealedUnit(Unit*);
	bool CanAttack();
	EndBattle CheckForEndSimulation();

	// UI functions
	void HandleUI();
	void AnimateLogo();
	void PrintMainMenue(string* files, int n, int selected, UIMode mode, FocusMode focusMode);

	void Print() const;
	void PrintSilentMessages() const;


	// Read / Write functions
	void ReadinputFile(UnitGenerator&);
	void outfile();
};

#define LOSE_MSG  R"(
  ______           _   _       _                      _     _                             _             _   _                      _       _     _            __       
 |  ____|         | | | |     | |                    | |   | |                           | |           | | | |                    (_)     | |   | |          / _|      
 | |__   __ _ _ __| |_| |__   | |_ _ __ ___ _ __ ___ | |__ | | ___  ___   _   _ _ __   __| | ___ _ __  | |_| |__   ___   _ __ ___  _  __ _| |__ | |_    ___ | |_       
 |  __| / _` | '__| __| '_ \  | __| '__/ _ \ '_ ` _ \| '_ \| |/ _ \/ __| | | | | '_ \ / _` |/ _ \ '__| | __| '_ \ / _ \ | '_ ` _ \| |/ _` | '_ \| __|  / _ \|  _|      
 | |___| (_| | |  | |_| | | | | |_| | |  __/ | | | | | |_) | |  __/\__ \ | |_| | | | | (_| |  __/ |    | |_| | | |  __/ | | | | | | | (_| | | | | |_  | (_) | |        
 |______\__,_|_|   \__|_| |_|  \__|_|  \___|_| |_| |_|_.__/|_|\___||___/  \__,_|_| |_|\__,_|\___|_|     \__|_| |_|\___| |_| |_| |_|_|\__, |_| |_|\__|  \___/|_|        
  _   _                  _ _                                                                                                          __/ |                            
 | | | |                | (_)                                                                                                        |___/                             
 | |_| |__   ___    __ _| |_  ___ _ __     ___ ___  _ __   __ _ _   _  ___ _ __ ___  _ __ ___                                                                          
 | __| '_ \ / _ \  / _` | | |/ _ \ '_ \   / __/ _ \| '_ \ / _` | | | |/ _ \ '__/ _ \| '__/ __|                                                                         
 | |_| | | |  __/ | (_| | | |  __/ | | | | (_| (_) | | | | (_| | |_| |  __/ | | (_) | |  \__ \_                                                                        
  \__|_| |_|\___|  \__,_|_|_|\___|_| |_|  \___\___/|_| |_|\__, |\__,_|\___|_|  \___/|_|  |___(_)                                                                       
   ____                    _ _   _             _ _        _  | |               _                                                                                       
  / __ \                  (_) | (_)           | (_)      (_) |_|              (_)                                                                                      
 | |  | |_   _ _ __    ___ _| |_ _  ___  ___  | |_  ___   _ _ __    _ __ _   _ _ _ __  ___                                                                             
 | |  | | | | | '__|  / __| | __| |/ _ \/ __| | | |/ _ \ | | '_ \  | '__| | | | | '_ \/ __|                                                                            
 | |__| | |_| | |    | (__| | |_| |  __/\__ \ | | |  __/ | | | | | | |  | |_| | | | | \__ \_                                                                           
  \____/ \__,_|_|     \___|_|\__|_|\___||___/ |_|_|\___| |_|_| |_| |_|   \__,_|_|_| |_|___( )                                                                          
                  _                      _                              __          _     |/ _       _                                  _            _           _     
                 | |                    | |                            / _|        | |      (_)     | |                                (_)          | |         | |    
   __ _ _ __   __| |   ___  _   _ _ __  | |__   ___  _ __   ___  ___  | |_ __ _  __| | ___   _ _ __ | |_ ___     ___ ___  ___ _ __ ___  _  ___    __| |_   _ ___| |_   
  / _` | '_ \ / _` |  / _ \| | | | '__| | '_ \ / _ \| '_ \ / _ \/ __| |  _/ _` |/ _` |/ _ \ | | '_ \| __/ _ \   / __/ _ \/ __| '_ ` _ \| |/ __|  / _` | | | / __| __|  
 | (_| | | | | (_| | | (_) | |_| | |    | | | | (_) | |_) |  __/\__ \ | || (_| | (_| |  __/ | | | | | || (_) | | (_| (_) \__ \ | | | | | | (__  | (_| | |_| \__ \ |_ _ 
  \__,_|_| |_|\__,_|  \___/ \__,_|_|    |_| |_|\___/| .__/ \___||___/ |_| \__,_|\__,_|\___| |_|_| |_|\__\___/   \___\___/|___/_| |_| |_|_|\___|  \__,_|\__,_|___/\__(_)
  _______ _                _                        | |                   __                                 __      _ _                                 _     _       
 |__   __| |              | |                       |_|                  / _|                               / _|    | | |                               | |   | |      
    | |  | |__   ___   ___| |_ __ _ _ __ ___  __      _____  ___ _ __   | |_ ___  _ __    ___  _   _ _ __  | |_ __ _| | | ___ _ __   __      _____  _ __| | __| |      
    | |  | '_ \ / _ \ / __| __/ _` | '__/ __| \ \ /\ / / _ \/ _ \ '_ \  |  _/ _ \| '__|  / _ \| | | | '__| |  _/ _` | | |/ _ \ '_ \  \ \ /\ / / _ \| '__| |/ _` |      
    | |  | | | |  __/ \__ \ || (_| | |  \__ \  \ V  V /  __/  __/ |_) | | || (_) | |    | (_) | |_| | |    | || (_| | | |  __/ | | |  \ V  V / (_) | |  | | (_| |_     
    |_|  |_| |_|\___| |___/\__\__,_|_|  |___/   \_/\_/ \___|\___| .__/  |_| \___/|_|     \___/ \__,_|_|    |_| \__,_|_|_|\___|_| |_|   \_/\_/ \___/|_|  |_|\__,_(_)    
                                                                | |                                                                                                    
                                                                |_|                                                                                                    
)"


#define WIN_MSG R"(
   _____                            _         _       _   _                                                                                                                             
  / ____|                          | |       | |     | | (_)                                                                                                                            
 | |     ___  _ __   __ _ _ __ __ _| |_ _   _| | __ _| |_ _  ___  _ __  ___                                                                                                             
 | |    / _ \| '_ \ / _` | '__/ _` | __| | | | |/ _` | __| |/ _ \| '_ \/ __|                                                                                                            
 | |___| (_) | | | | (_| | | | (_| | |_| |_| | | (_| | |_| | (_) | | | \__ \_                                                                                                           
  \_____\___/|_| |_|\__, |_|  \__,_|\__|\__,_|_|\__,_|\__|_|\___/|_| |_|___( )                                                                                                          
  _                  __/ |                            _                _   |/                                                                                                           
 | |                |___/                            (_)              | |                                                                                                               
 | |__  _ __ __ ___   _____  __      ____ _ _ __ _ __ _  ___  _ __ ___| |                                                                                                               
 | '_ \| '__/ _` \ \ / / _ \ \ \ /\ / / _` | '__| '__| |/ _ \| '__/ __| |                                                                                                               
 | |_) | | | (_| |\ V /  __/  \ V  V / (_| | |  | |  | | (_) | |  \__ \_|                                                                                                               
 |_.__/|_|  \__,_| \_/ \___|   \_/\_/ \__,_|_|  |_|  |_|\___/|_|  |___(_)                                                                                                               
  _______ _                  _ _              _                     _               _                 _                       _   _                       _           _                 
 |__   __| |                | (_)            (_)                   (_)             | |               | |                     | | | |                     | |         | |                
    | |  | |__   ___    __ _| |_  ___ _ __    _ _ ____   ____ _ ___ _  ___  _ __   | |__   __ _ ___  | |__   ___  ___ _ __   | |_| |____      ____ _ _ __| |_ ___  __| |                
    | |  | '_ \ / _ \  / _` | | |/ _ \ '_ \  | | '_ \ \ / / _` / __| |/ _ \| '_ \  | '_ \ / _` / __| | '_ \ / _ \/ _ \ '_ \  | __| '_ \ \ /\ / / _` | '__| __/ _ \/ _` |                
    | |  | | | |  __/ | (_| | | |  __/ | | | | | | | \ V / (_| \__ \ | (_) | | | | | | | | (_| \__ \ | |_) |  __/  __/ | | | | |_| | | \ V  V / (_| | |  | ||  __/ (_| |_               
    |_|  |_| |_|\___|  \__,_|_|_|\___|_| |_| |_|_| |_|\_/ \__,_|___/_|\___/|_| |_| |_| |_|\__,_|___/ |_.__/ \___|\___|_| |_|  \__|_| |_|\_/\_/ \__,_|_|   \__\___|\__,_(_)              
  _    _                             _ _                                                                    _      _     _            __                   _   _ _             _        
 | |  | |                           (_) |                                                                  | |    | |   | |          / _|                 | | (_) |           | |       
 | |__| |_   _ _ __ ___   __ _ _ __  _| |_ _   _    _____      _____  ___   _   _  ___  _   _    __ _    __| | ___| |__ | |_    ___ | |_    __ _ _ __ __ _| |_ _| |_ _   _  __| | ___   
 |  __  | | | | '_ ` _ \ / _` | '_ \| | __| | | |  / _ \ \ /\ / / _ \/ __| | | | |/ _ \| | | |  / _` |  / _` |/ _ \ '_ \| __|  / _ \|  _|  / _` | '__/ _` | __| | __| | | |/ _` |/ _ \  
 | |  | | |_| | | | | | | (_| | | | | | |_| |_| | | (_) \ V  V /  __/\__ \ | |_| | (_) | |_| | | (_| | | (_| |  __/ |_) | |_  | (_) | |   | (_| | | | (_| | |_| | |_| |_| | (_| |  __/_ 
 |_|  |_|\__,_|_| |_| |_|\__,_|_| |_|_|\__|\__, |  \___/ \_/\_/ \___||___/  \__, |\___/ \__,_|  \__,_|  \__,_|\___|_.__/ \__|  \___/|_|    \__, |_|  \__,_|\__|_|\__|\__,_|\__,_|\___(_)
 __      ___      _                     _   __/ |                    _       __/ |                                                          __/ |                                       
 \ \    / (_)    | |                   (_) |___/                    | |     |___/                                                          |___/                                        
  \ \  / / _  ___| |_ ___  _ __ _   _   _ ___    ___  _   _ _ __ ___| |                                                                                                                 
   \ \/ / | |/ __| __/ _ \| '__| | | | | / __|  / _ \| | | | '__/ __| |                                                                                                                 
    \  /  | | (__| || (_) | |  | |_| | | \__ \ | (_) | |_| | |  \__ \_|                                                                                                                 
     \/   |_|\___|\__\___/|_|   \__, | |_|___/  \___/ \__,_|_|  |___(_)                                                                                                                 
                                 __/ |                                                                                                                                                  
                                |___/                                                                                                                                                   
)"
#endif // !GAME_H=